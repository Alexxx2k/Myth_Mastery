<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <title>Управление пользователями - Автосервис</title>
    <link rel="stylesheet" th:href="@{/css/tablesPages.css}">
</head>
<body>
<div class="container">
    <a th:href="@{/}" class="back-link">← Назад на главную</a>
    <h1>Управление пользователями</h1>

    <div th:if="${message}" th:class="${'success'.equals(messageType)} ? 'message success' : 'message error'"
         th:text="${message}">
    </div>

    <div class="menu">
        <a th:href="@{/users/create}">➕ Создать пользователя</a>
    </div>

    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Имя пользователя</th>
            <th>Роль</th>
            <th>Дата создания</th>
            <th>Действия</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${#lists.isEmpty(users)}">
            <td colspan="6" style="text-align: center; color: #666; padding: 20px;">
                Нет пользователей в базе данных
            </td>
        </tr>
        <tr th:each="user : ${users}">
            <td th:text="${user.id}"></td>
            <td th:text="${user.username}"></td>
            <td>
                <span th:class="'role-badge role-' + ${user.role.toLowerCase()}"
                      th:text="${user.role}">
                </span>
            </td>
            <td th:text="${#temporals.format(user.createdAt, 'dd.MM.yyyy HH:mm')}"></td>
            <td class="actions">
                <a th:href="@{/users/edit/{id}(id=${user.id})}" class="btn-edit">Редактировать</a>
                <form th:action="@{/users/delete/{id}(id=${user.id})}" method="post" style="display: inline;">
                    <button type="submit" class="btn-delete"
                            onclick="return confirm('Вы уверены, что хотите удалить этого пользователя?')">
                        Удалить
                    </button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

</div>
</body>
</html>