# Myth Mastery
___
Проект в рамках дисциплины «Конструирование программного обеспечения».
Онлайн-сервис для приобретения атрибутики различных мифологий.

## Участники
___
- Псарев Александр Сергеевич, 5130904/30105
- Никифоров Александр Вячеславович, 5130904/30105
- Зинаков Семен Сергеевич, 5130904/30105
- Ананьев АртЕм Максимович, 5130904/30105
- Соболевский Михаил Андреевич, 5130904/30105

## Определение проблемы
___
Энтузиасты, коллекционеры и просто любители мифологии сталкиваются с отсутствием централизованного маркетплейса,
который бы объединял атрибутику, товары и сувениры, связанные с различными мифологическими культурами.
Пользователям приходится искать товары на разных площадках, форумах и в узкоспециализированных магазинах, что затрудняет
поиск, сравнение цен и выбор качественной продукции. Отсутствие единой
платформы с системой отзывов, рекомендаций и удобной навигацией по тематическим категориям снижает доступность и
популярность мифологической атрибутики.

## Выработка требований
___
### Пользовательские истории
1. Как покупатель, я хочу просматривать товары (фигурки, книги, украшения, одежда) по категориям мифологий
(греческая, скандинавская, египетская и др.), чтобы легко находить тематическую атрибутику.
2. Как зарегистрированный пользователь, я хочу добавлять товары в корзину, оформлять заказы и отслеживать их статус,
чтобы удобно совершать покупки и контролировать доставку.
3. Как администратор, я хочу управлять каталогом товаров (добавлять, редактировать, удалять позиции).

## Разработка архитектуры и детальное проектирование
___
### Оценка масштаба
> 10 000 пользователей в сутки.

### Характер нагрузки
- #### **R/W**: 70% на чтение, 30% на запись.
Большая часть операций — это просмотр каталога, чтение описаний товаров и отзывов. 
Запись происходит при регистрации, добавлении в корзину, оформлении заказов и оставлении отзывов.
- #### **Трафик**: ~50 ГБ/день
В среднем пользователь просматривает 20 товаров в день (изображения + описание ≈ 2 МБ).
10 000 × 2 МБ = 20 ГБ (трафик каталога) + 30 ГБ (загрузки изображений, статики) = ~50 ГБ/день.
- #### **Диск**: ~2 ТБ для первого года работы.
Данные пользователей, заказы, отзывы: ~100 МБ/пользователь × 10 000 = 1 ТБ.
Логи, бэкапы, медиа: ~1 ТБ.

### Диаграммы C4 Model
*Не реализовано*

### Контракты API
*Не реализовано*

### Схема БД
___
![MMDB](src/main/resources/images/MMDB.png)

#### Описание таблиц:
___
| Имя таблицы | Описание                                                                                                                                                                            |        
|-------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| category    | Содержит список категорий, к которым могут принадлежать товары.<br/>Тут же представлены характеристики "редкость" и "опасность" товара.                                             |                                
| mythology   | Таблица содержит все мифологии, представленные в магазине.                                                                                                                          |
| product     | Содержит подробные описания конкретных товаров. Тут же содержится<br/>изображение товара и его цена. Таблицы **_category_** и **_mythology_** подвязаны<br/>сюда как **OneToMany**. |
| city        | Содержит список городов, доступных для доставки,<br/> а также время доставки до них.                                                                                                |                                                                                                
| customer    | Содержит имена всех зарегистрированных покупателей и адреса их электронных почт.                                                                                                    |                                                                                                    
| step        | Содержит все стадии, которые проходит процесс доставки заказа.                                                                                                                      |                                                                                                                      
| buy         | Содержит сформированные заказы, их описание, стадию доставки и покупателя.                                                                                                          |                                                                                                          
| buy_step    | Реализует связь **ManyToMany** между таблицами **_buy_** и **_step_**.                                                                                                              |                                                                                                              
| buy_product | реализует связь **ManyToMany** между таблицами **_buy_** и **_product_**.  

### Схема масштабирования
Вероятны следующие подходы:
- #### Горизонтальное масштабирование веб-слоя
Размещение 3-5 инстансов Spring Boot приложения за балансировщиком Nginx или Traefik.
Вынос сессионных данных из памяти приложения в Redis для поддержки stateless-архитектуры.
- #### Асинхронная обработка операций
Очереди сообщений (RabbitMQ/Kafka):
обработка оформления заказов, отправка email-уведомлений, обновление инвентаря.
Использование Spring Batch для массовых операций (импорт товаров, генерация отчетов)
- #### Оптимизация базы данных
Репликация PostgreSQL:
1 мастер для операций записи (заказы, обновления товаров);
2-3 реплики для операций чтения (просмотр каталога, поиск, история заказов).
Шардинг по категориям: разделение данных по типам мифологий на разные серверы БД.

## Кодирование и отладка
___
### Технологический стек
- **Backend**: Java, Spring Boot, Spring Web, Spring Security, Maven
- **База данных**: PostgreSQL
- **Frontend**: Thymeleaf
- **Дополнительно**: Docker

### Unit-Тестирование
*Не реализовано*

### Интеграционное тестирование
*Не реализовано*

### Сборка и запуск
Для сборки и запуска веб-сервиса со всеми зависимостями необходимо:
- Склонировать репозиторий.
- Запустить Docker.
- Выполнить в терминале:
```bash
docker-compose up -d
./mvnw.cmd clean package
./mvnw.cmd spring-boot:run
```
- После этого встанет сервер бекенда на localhost:8080.
- Если запускать из IDEA, то есть специальный файл src\main\java\com\alexxx2k\springproject\SpringProjectApplication.
